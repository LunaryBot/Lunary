// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Embed {
  guild_id                     String
  type                         EmbedType

  content                      String?

  embed_title                  String?
  embed_description            String?
  embed_url                    String?
  embed_timestamp              String?
  embed_color                  String?

  // Footer
  embed_footer_text            String?
  embed_footer_icon_url        String?
  embed_footer_proxy_icon_url  String?

  // Image
  embed_image_url              String?
  embed_image_proxy_url        String?
  embed_image_height           Int?
  embed_image_width            Int?

  // Thumbnail
  embed_thumbnail_url          String?
  embed_thumbnail_proxy_url    String?
  embed_thumbnail_height       Int?
  embed_thumbnail_width        Int?

  // Field
  embed_fields                 Json[]    @default([])

  @@id([guild_id, type])
}

enum EmbedType {
  BAN
  KICK
  MUTE
  ADV
  NOFITYDM
}

model Guild {
  id                  String              @id @unique
  modlogs_channel     String?
  punishments_channel String?
  features            BigInt?
  permissions         GuildPermissions[]
  reasons             Reason[]
  premium_type        GuildPremiumType?
  premium_until       DateTime?
}

model GuildPermissions {
  id          String
  type        GuildPermissionType
  guild_id    String
  permissions BigInt

  guild       Guild?                @relation(fields: [guild_id], references: [id])

  @@id([guild_id, id])
}

enum GuildPermissionType {
  ROLE
  MEMBER
  COMMAND
}

enum GuildPremiumType {
  BASIC
  PLUS
}

model Punishment {
  id         Int            @id @unique @default(autoincrement())
  guild_id   String
  user_id    String
  author_id  String
  type       PunishmentType
  created_at DateTime
  flags      BigInt         @default(0)
  duration   Int?
  reason     String?
  reason_id  String?
  deleted    Boolean?       @default(false)
}

enum PunishmentType {
  BAN
  MUTE
  KICK
  ADV
}

model Reason {
  id       String           @id @unique @default(cuid())
  text     String
  guild_id String
  type     PunishmentType[]
  keys     String[]         @default([])
  duration Int?
  days     Int?

  guild    Guild?           @relation(fields: [guild_id], references: [id])
}

model User {
  id                         String           @id @unique
  features                   BigInt?
  flags                      BigInt?

  luas                       Int?
  last_daily_at              DateTime?

  bio                        String?
  xp                         Int?
  inventory                  BigInt?
  inventary_using            BigInt?

  premium_type               UserPremiumType?
  premium_until              DateTime?
}

enum UserPremiumType {
  PLUS
}